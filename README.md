# ğŸšŒ Backend - à¸£à¸°à¸šà¸šà¸ˆà¸­à¸‡à¸£à¸–à¸£à¸±à¸š-à¸ªà¹ˆà¸‡à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥

## ğŸ“‹ à¹€à¸à¸µà¹ˆà¸¢à¸§à¸à¸±à¸šà¹‚à¸›à¸£à¹€à¸ˆà¸„

à¸£à¸°à¸šà¸šà¸ˆà¸­à¸‡à¸£à¸–à¸£à¸±à¸š-à¸ªà¹ˆà¸‡à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥ à¹€à¸›à¹‡à¸™à¸£à¸°à¸šà¸šà¸—à¸µà¹ˆà¸Šà¹ˆà¸§à¸¢à¹ƒà¸«à¹‰à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢à¸ªà¸²à¸¡à¸²à¸£à¸–à¸ˆà¸­à¸‡à¸£à¸–à¸£à¸±à¸š-à¸ªà¹ˆà¸‡à¹„à¸›à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥à¹„à¸”à¹‰à¸­à¸¢à¹ˆà¸²à¸‡à¸ªà¸°à¸”à¸§à¸ à¹‚à¸”à¸¢à¸¡à¸µà¸Ÿà¸µà¹€à¸ˆà¸­à¸£à¹Œà¸«à¸¥à¸±à¸à¸”à¸±à¸‡à¸™à¸µà¹‰:

- ğŸ¥ **à¸ˆà¸­à¸‡à¸£à¸–à¸£à¸±à¸š-à¸ªà¹ˆà¸‡** - à¸œà¸¹à¹‰à¸›à¹ˆà¸§à¸¢à¸ªà¸²à¸¡à¸²à¸£à¸–à¸ˆà¸­à¸‡à¸£à¸–à¹„à¸›à¹‚à¸£à¸‡à¸à¸¢à¸²à¸šà¸²à¸¥
- ğŸ‘¨â€âš•ï¸ **à¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸²à¸£à¸ˆà¸­à¸‡** - à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¹à¸¥à¸°à¹à¸­à¸”à¸¡à¸´à¸™à¸ªà¸²à¸¡à¸²à¸£à¸–à¸ˆà¸±à¸”à¸à¸²à¸£à¸à¸²à¸£à¸ˆà¸­à¸‡
- ğŸ“± **LINE Integration** - à¸£à¸±à¸šà¸à¸²à¸£à¹à¸ˆà¹‰à¸‡à¹€à¸•à¸·à¸­à¸™à¸œà¹ˆà¸²à¸™ LINE
- ğŸ“Š **Dashboard** - à¹à¸”à¸Šà¸šà¸­à¸£à¹Œà¸”à¸ªà¸³à¸«à¸£à¸±à¸šà¸”à¸¹à¸ªà¸–à¸´à¸•à¸´à¹à¸¥à¸°à¸£à¸²à¸¢à¸‡à¸²à¸™
- ğŸ” **à¸£à¸°à¸šà¸š Authentication** - à¸¥à¹‡à¸­à¸à¸­à¸´à¸™/à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸

## ğŸ› ï¸ à¹€à¸—à¸„à¹‚à¸™à¹‚à¸¥à¸¢à¸µà¸—à¸µà¹ˆà¹ƒà¸Šà¹‰

- **Backend**: Node.js + Express.js
- **Database**: MySQL
- **Authentication**: JWT + bcrypt
- **Email**: Nodemailer
- **LINE API**: LINE Login + Messaging API
- **PDF**: jsPDF
- **Deployment**: Railway

## ğŸš€ à¸à¸²à¸£à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡à¹à¸¥à¸°à¸£à¸±à¸™

### Prerequisites
- Node.js (v16+)
- MySQL
- LINE Developer Account

### 1. Clone Repository
```bash
git clone <repository-url>
cd shuttle-system-backend
```

### 2. à¸•à¸´à¸”à¸•à¸±à¹‰à¸‡ Dependencies
```bash
npm install
```

### 3. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Environment Variables
```bash
# Copy .env.example to .env
cp .env.example .env

# à¹à¸à¹‰à¹„à¸‚ .env à¸•à¸²à¸¡à¸à¸²à¸£à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸‚à¸­à¸‡à¸„à¸¸à¸“
```

### 4. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸²à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥
```bash
# à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸™à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ MySQL
# Import schema (à¸–à¹‰à¸²à¸¡à¸µ)
```

### 5. à¸£à¸±à¸™ Server
```bash
# Development
npm run dev

# Production
npm start
```

## ğŸ“ à¹‚à¸„à¸£à¸‡à¸ªà¸£à¹‰à¸²à¸‡à¹„à¸Ÿà¸¥à¹Œ

```
server/
â”œâ”€â”€ ğŸ“„ server.js              # Main server file
â”œâ”€â”€ ğŸ“„ package.json           # Dependencies
â”œâ”€â”€ ğŸ“„ db.js                  # Database connection
â”œâ”€â”€ ğŸ“„ auth.js                # Authentication logic
â”œâ”€â”€ ğŸ“„ appointments.js        # Appointment management
â”œâ”€â”€ ğŸ“„ profile.js             # Profile management
â”œâ”€â”€ ğŸ“„ mailer.js              # Email service
â”œâ”€â”€ ğŸ“„ locations.js           # Location data
â”œâ”€â”€ ğŸ“ services/
â”‚   â””â”€â”€ ğŸ“„ lineService.js     # LINE API service
â”œâ”€â”€ ğŸ“ routes/
â”‚   â””â”€â”€ ğŸ“„ lineRoutes.js      # LINE API routes
â”œâ”€â”€ ğŸ“ docs/
â”‚   â”œâ”€â”€ ğŸ“„ railway-deploy-guide.md
â”‚   â”œâ”€â”€ ğŸ“„ environment-setup.md
â”‚   â””â”€â”€ ğŸ“„ production-checklist.md
â””â”€â”€ ğŸ“„ railway.json           # Railway deployment config
```

## ğŸ”§ Environment Variables

### Local Development
```env
NODE_ENV=development
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=railway
DB_PORT=3306
PORT=3001
FRONTEND_URL=http://localhost:5173
RAILWAY_PUBLIC_DOMAIN=your-backend-domain.railway.app
```

### Production (Railway)
```env
NODE_ENV=production
DB_HOST=containers-us-west-xxx.railway.app
DB_USER=root
DB_PASSWORD=your_railway_mysql_password
DB_NAME=railway
DB_PORT=3306
PORT=3001
FRONTEND_URL=https://your-frontend-domain.railway.app
RAILWAY_PUBLIC_DOMAIN=your-backend-domain.railway.app
```

## ğŸ“± LINE Integration

### 1. à¸ªà¸£à¹‰à¸²à¸‡ LINE Channels
- LINE Login Channel
- LINE Messaging API Channel

### 2. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Environment Variables
```env
LINE_LOGIN_CHANNEL_ID=your_channel_id
LINE_LOGIN_CHANNEL_SECRET=your_channel_secret
LINE_MESSAGING_CHANNEL_ID=your_messaging_channel_id
LINE_MESSAGING_CHANNEL_SECRET=your_messaging_channel_secret
LINE_MESSAGING_ACCESS_TOKEN=your_access_token
```

### 3. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Callback URLs
- **Local**: `http://localhost:3001/api/line/login-callback`
- **Production**: `https://your-backend-domain.railway.app/api/line/login-callback`

## ğŸš€ Deployment

### Railway Deployment
1. Push code à¹„à¸› GitHub
2. Connect GitHub repo à¸à¸±à¸š Railway
3. à¸•à¸±à¹‰à¸‡à¸„à¹ˆà¸² Environment Variables
4. Deploy

à¸”à¸¹à¸£à¸²à¸¢à¸¥à¸°à¹€à¸­à¸µà¸¢à¸”à¹€à¸à¸´à¹ˆà¸¡à¹€à¸•à¸´à¸¡à¹ƒà¸™ [railway-deploy-guide.md](./railway-deploy-guide.md)

## ğŸ“Š API Endpoints

### Authentication
- `POST /login` - à¸¥à¹‡à¸­à¸à¸­à¸´à¸™
- `POST /register` - à¸ªà¸¡à¸±à¸„à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸
- `POST /verify-otp` - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸š OTP

### Appointments
- `GET /appointments` - à¸”à¸¶à¸‡à¸£à¸²à¸¢à¸à¸²à¸£à¸à¸²à¸£à¸ˆà¸­à¸‡
- `POST /appointments/user/:userId` - à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸ˆà¸­à¸‡ (à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰)
- `POST /appointments/staff` - à¸ªà¸£à¹‰à¸²à¸‡à¸à¸²à¸£à¸ˆà¸­à¸‡ (à¹€à¸ˆà¹‰à¸²à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ)
- `PUT /appointments/:id` - à¸­à¸±à¸›à¹€à¸”à¸•à¸à¸²à¸£à¸ˆà¸­à¸‡
- `DELETE /appointments/:id` - à¸¥à¸šà¸à¸²à¸£à¸ˆà¸­à¸‡

### LINE Integration
- `GET /api/line/login-url/:userId` - à¸ªà¸£à¹‰à¸²à¸‡ LINE Login URL
- `POST /api/line/callback` - à¸ˆà¸±à¸”à¸à¸²à¸£ LINE Login callback
- `GET /api/line/status/:userId` - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸° LINE
- `POST /api/line/disconnect/:userId` - à¸¢à¸à¹€à¸¥à¸´à¸à¸à¸²à¸£à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­ LINE

## ğŸ” Health Check
- `GET /health` - à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸–à¸²à¸™à¸° server

## ğŸ“ License

ISC License

## ğŸ‘¥ Contributors

- [Your Name] - Initial work

## ğŸ“ Support

à¸«à¸²à¸à¸¡à¸µà¸›à¸±à¸à¸«à¸²à¸«à¸£à¸·à¸­à¸„à¸³à¸–à¸²à¸¡ à¸à¸£à¸¸à¸“à¸²à¸•à¸´à¸”à¸•à¹ˆà¸­ [your-email@example.com]
